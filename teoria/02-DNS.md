# DNS

1. ¿Cómo y por qué surge DNS?

El servicio de DNS(Domain Name System) tiene la particularidad que, en la mayorı́a de los casos, no es utilizado directamente por los usuarios o aplicaciones, sino que funciona como un apoyo al resto de los servicios y sistemas de Internet. Su objetivo principal es el de traducir nombres de dominio a direcciones de Internet(direcciones IP) y, de esta forma, lograr una abstracción de las direcciones de red utilizadas internamente por los protocolos. Esto permite ubicar a un dispositivo por su nombre sin importar cual es la dirección IP que tiene asignada en ese momento. Otra ventaja es que las personas no necesitan recordar las direcciones IP. Para IPv4, recordar cuatro números no parece tan complicado, el problema surge cuando se deben recordar muchos de estos números y el caso empeora con la necesidad de recordar direcciones IPv6(128 bits).
El sistema de DNS es un sistema distribuido de forma jerárquica, el cual está conformado por muchos servidores a lo largo y ancho de todo el mundo. Cada servidor tendrá la responsabilidad de mantener una parte dentro de la jerarquı́a de nombres. El hecho de utilizar nombres en lugar de direcciones data de 1973. En esa época, se tenı́a un archivo global, HOSTS.TXT, que era mantenido por el SRI (Stanford Research Institute, hoy SRI International). Dentro del SRI, esta tarea dio lugar a la creación del NIC(Network Information Center). El servicio funcionaba de forma completamente centralizada. El archivo HOSTS.TXT estaba disponible para "bajar" utilizando el protocolo FTP y las modificaciones al mismo eran solicitadas vı́a e-mail. Cada determinado tiempo se juntaban las solicitudes de actualizaciones, se cambiaba el archivo y se generaba una nueva versión disponible al público. El sistema centralizado aseguraba que el NIC asignara las direcciones de forma consistente, pero tenı́a el problema de no ser escalable. Para 1980, este método era muy difı́cil de mantener por lo que empezaron las investigaciones para reemplazarlo. El encargado de diseñar el nuevo sistema fue Paul Mockapetris. El sistema diseñado por éste trabaja de forma distribuida, pero concentra el comienzo de las búsquedas en un conjunto de servidores raı́ces y luego delega de forma jerárquica. La primera implementación de un servidor de DNS fue realizada en 1984 en la Universidad de Berkeley y ejecutaba sobre Unix BSD. Más tarde, al ser re-escrita por otros estudiantes de la misma universidad, fue nombrada BIND(Berkeley Internet Name Domain). En la actualidad, hay diferentes versiones del servidor DNS mantenidas por el ISC(Internet Systems Consortium), que fue fundado por Paul Vixie en 1994. Además, ha sido portado a una gran cantidad de plataformas.

2. ¿Cómo es el sistema de nombres?

El espacio de nombres de Internet, sobre el cual trabaja el DNS, ha sido organizado de forma jerárquica a través de dominios, sub-dominios y nombres finales. Cada eslabón de la jerarquı́a es un dominio o sub-dominio(también llamados ZONAS) que contiene un espacio de nombres bajo esa denominación. Existen dominios de primer nivel en la jerarquı́a, conocidos como TLD (Top Level Domains), que están predefinidos. Actualmente, los TLDs son manejados por el IANA(Internet Assigned Numbers Authority) a través del ICANN (Internet Corporation for Assigned Names and Numbers). En un principio, eran manejados directamente por InterNIC. Si se acepta o rechaza agregar un nombre al tope de la jerarquı́a es decidido por el ICANN. Han surgido como alternativa otras organizaciones buscando su reemplazo, por ejemplo Open Root Server Network (ORSN) con apoyo europeo. Esta opero desde 2002 hasta 2008. Se mantenı́a sincronizada con los servidores del ICANN, pero trabajaba con polı́ticas independientes. Otro es OpenNIC, que acepta otros nombres en el nivel raı́z, como por ejemplo: .geek, .bbs, .free, .null. Entre 2011 y 2012 el ICANN abrió los gTLD lanzando el “New gTLD Program”. Esto permite poder registrar cualquier nombre de dominio en el tope de la jerarquı́a. Para 2015 hay más de 500 nuevos dominios, como .beer, .paris, etc.
El registro de los nombres no está concentrado todo en el ICANN. Éste se encarga de administrar los TLD, y luego delega registros por cada paı́s (ccTLD). Por ejemplo, para la Argentina la entidad encargada es NIC.AR. Es también posible delegar dominios raı́ces a otras organizaciones.
El ICANN también estarı́a encargado de administrar las direcciones IPv4, direcciones IPv6 y los números de sistemas autónomos (AS). Estas tareas no se concentran todas en el ICANN, sino que son delegadas a los Registros de Internet Regionales, en inglés RIRs (Regional Internet Registry). Éstas son organizaciones que tienen a cargo diferentes regiones del mundo. Actualmente, existen las siguientes:
* American Registry for Internet Numbers (ARIN) para EE.UU., Canadá y parte del Caribe.
* Réseaux IP Européens Network Coordination Centre (RIPE NCC) para Europa, Asia Central y Media.
* Asia-Pacific Network Information Centre (APNIC) para el resto de Asia y el Pacı́fico.
* Latin American and Caribbean NIC (LACNIC) para América Latina y el resto del Caribe.
* African Network Information Centre (AfriNIC) para Africa.
Las organizaciones que mantienen los registros brindan servicios de consulta vı́a HTTP o el protocolo WHOIS con el que se podrı́an consultar los datos referentes a un dominio o un rango de direcciones IP.

3. ¿Que son los TLD(*Top Level Domain*)?

Los TLD más importantes se podrı́an clasificar en 3 grupos:
gTLD(*Generic TLD*): contienen dominios con propósitos particulares, de acuerdo a diferentes actividades. Para 1980, los gTLD eran: .com, .edu, .gov, .int, .mil, .net y .org, pero sólo .com, .net y .org tenı́an libre el registro, el resto estaban dedicados, únicamente, a organizaciones de los Estados Unidos u organizaciones Internacionales. Debido a esto, se creı́a que todos los registros(incluso los 3 libres) se encontraban en Estados Unidos. Las polı́ticas de uso y registro pueden estar definidas por el ICANN, en ese caso se llaman Unsponsored TLD, o, si son definidas por otra organización a la cual se le delega el control se los llama Sponsored TLD. Los dominios .com aún hoy son administrados por empresas lucrativas como VeriSign.
ccTLD(*Country-Code TLD*): contienen dominios delegados a los diferentes paises del mundo. Los códigos de los paises están codificados en dos sı́mbolos, habitualmente letras, y actualmente se admiten sı́mbolos o letras de otros alfabetos. Se encuentra por ejemplo .ar(Argentina), .uk(Reino Unido), .ru(Rusia), .us(Estados Unidos), etc. Algunos paı́ses como el caso de
Tuvalu (.tv) o Colombia (.co) delegan la administración de dominios a empresas/organizaciones para obtener ganancias.
.ARPA TLD: es un dominio especial, llamado de infraestructura, usado internamente por los protocolos, creado para resolución de reversos: de direcciones a nombres.

4. ¿Qué es un nombre de dominio?

Un nombre de dominio es una lista de labels (etiquetas) separadas por puntos que van desde el nodo(el label más a la izquierda) hasta la raı́z del árbol(el punto). No son case-sensitive y cada label puede tener como máximo 63 caracteres. La cantidad máxima de labels es 127 y el nombre no puede tener más de 255 caracteres en total. Al nombre completo se lo identifica como FQDN(Full Qualified Domain Name) y se distingue por terminar con un punto(dot). Si no termina con punto, se le puede agregar/concatenar, al momento de hacer la búsqueda, un espacio al dominio. Si el nombre sólo tiene un label se le agrega un dominio; si tiene más eslabones, generalmente, se lo considera como un FQDN.

5. ¿Cómo se realiza la delegación de Sub-dominios/Zonas?

Una vez definido el espacio de nombres, y su administración, es necesario asignarlo a diferentes servidores de manera distribuida. Para 1993, habı́a 8 servidores, llamados ROOT Servers(Servidores Raı́ces), encargados de atender la raı́z del servicio. Estos eran administrados por InterNIC y se encargaban de delegar cada una de las zonas generadas para los TLD, tanto gTLD como ccTLD. La delegación consiste en saber las direcciones IP de los servidores que se encargan de resolver(o sub-delegar) las zonas de manera autoritativa. Un servidor autoritativo tiene toda la información para una zona, puede producir cambios sobre la misma y es el que tiene la última versión. En la actualidad, existen 13 ROOT Servers distribuidos en todo el mundo, 7 de los cuales no son servidores únicos, sino que trabajan con redundancia y las réplicas están distribuidos geográficamente. Con esta redundancia, combinada con Ruteo Anycast, se logra que los requerimientos se atiendan según la proximidad, logrando mejores tiempos de respuesta. La cantidad de servidores raı́ces está acotada a 13 debido a la limitación de 512 bytes de un mensaje de DNS sobre UDP.

6. ¿Cómo registro un nombre de dominio?

En el proceso entran en juego diferentes entidades:
* Registrant: cliente/entidad final, el que requiere registrar el nombre de dominio.
* Registry: repositorio autoritativo responsable por el funcionamiento y la información en un TLD particular. Debe proveer la infraestructura de los servidores para resolver el servicio desde la raı́z.
* Register: interfaz entre el Registry y el Registrant. Puede proveer servicios adicionales al Registrant. Depende de cada dominio como serán las polı́ticas. Las polı́ticas siempre deben estar en el marco de las definidas por el ICANN. Para un TLD debe existir solo una autoridad responsable, el Registry. Los Registrant contactan a un Register para la operación.
NIC.ar cumplirı́a el rol de Registry. Para el registro de dominios .edu.ar, el trámite debe realizarse ante la ARIU(Asociación de Redes Inter Universitaria) de la Argentina. Para registrar dominios .com esto se debe realizar ante una empresa autorizada por el ICANN, Registers. Para algunos dominios se pude hacer el trámite directamente sobre el Registry.
Para registrar un dominio .com.ar es necesario hacerlo ante NIC.ar indicando la Entidad Registrante(Registrant), de la Persona Responsable y los DNS correspondientes a los servidores que resolverán el nombre de dominio. Puede suceder que el dominio al tiempo de registro no tenga asociados los servidores, esto puede realizarse más tarde realizando la Transferencia de Dominio. Para la transferencia se requieren al menos dos servidores de nombres autoritativos para el dominio registrado. Para realizar el trámite requiere un casilla de e-mail a la cual se le notifica el estado del mismo. No existen Registers, pero ISPs pueden cumplir un rol similar ofreciendo el servicio. No hay acuerdo entre Registry, NIC.ar e ISP. Para la obtención de un bloque de direcciones IP en nuestra región geográfica se debe tramitar ante un ISP local o directamente ante LACNIC. Para otros paı́ses fuera de nuestra región se debe contactar el RIR adecuado. En el caso de hacerlo ante un ISP el bloque serı́a delegado por el ISP, sin ser propio.

7. ¿Qué servidores de DNS existen?

Los tipos de servidores de DNS se pueden clasificar en 3 grupos, no siendo estos disjuntos, es decir, un servidor puede pertenecer a más de un grupo.
* Servidor Raı́z: es un servidor que cumple el rol descripto anteriormente en la delegación de Sub-dominios/Zonas.
* Servidor Autoritativo: es un servidor que tiene a cargo una zona o sub-dominio de nombres. Es el responsable del mantenimiento de la misma. Pueden existir uno o más servidores responsables de una zona. A su vez, un servidor puede ser responsable de varias zonas. Si un sub-sub-dominio es delegado dentro de esta zona, el servidor debe saber a qué servidor(es) sub-delegarlo.
* Servidor Local: es un servidor que es consultado dentro de una red. Es el encargado de resolver los nombres solicitados por los clientes. Mantiene una cache con los nombres que va resolviendo. Al mismo tiempo, puede ser Servidor Autoritativo de la zona o espacio de nombres de los equipos de su red. Habitualmente también se los llama Servidor Recursivo porque responde estas consultas a los clientes internos o Servidor Cache porque almacena temporalmente los registros que obtiene.

Otra solución en lugar de usar un DNS local(tanto en la red como en el propio equipo), es utilizar un Open DNS/Open NS, estos son servidores de DNS globales que permiten utilizase como locales admitiendo consultas recursivas. Algunos de estos servicios funcionan en un esquema anycast.
Existe otro tipo de servidor de DNS llamado Forwarder Name Server. Éste es un servidor que interactúa directamente con los ROOT Name Servers y con el resto del sistema de DNS, haciendo de intermediario o proxy entre los servidores locales y el mundo exterior. Este tipo de configuración se utiliza, habitualmente, por cuestiones de seguridad. Sólo se permiten/restringen consultas de DNS que salgan de la red local desde los Forwarder Name Server. Hay implementaciones livianas(lightweight) de Forwarders que combinan un DNS proxy con un DHCP server y un servicio de NAT. Un ejemplo de
esto es Dnsmasq que es muy útil para una intranet de tamaño pequeño o mediano.

8. ¿Qué representa el cliente, servidor y resolver?

El protocolo de DNS puede trabajar sobre dos protocolos de transporte: TCP y UDP, siendo UDP el más utilizado. El número de puerto usado por el servidor es el 53 para ambos casos. El cliente puede escoger cualquier puerto no privilegiado(> a 1023). El protocolo UDP es utilizado en las consultas y en la mayorı́a de las respuestas. TCP se utilizará en caso de que la respuesta UDP exceda los 512 bytes o en el caso particular de una Transferencia de Zona(copia de la base de datos de nombres de un servidor primario o master a uno secundario -antiguamente llamados esclavos-).
El funcionamiento del DNS se realiza en un esquema cliente/servidor, siendo el cliente cualquier aplicación que requiera la resolución de nombres. Las instrucciones de máquina que usa el cliente se lo agrupa en un módulo llamado Resolver. El Resolver se lo podrı́a considerar como un agente encargado de resolver los nombres a solicitud del cliente, por ejemplo: un servidor web, el cliente telnet, un navegador web, un servidor de mail, etc. Este agente, generalmente, no se implementa como un servicio activo, sino como un conjunto de rutinas encapsuladas en una biblioteca de funciones que se link-edita conjuntamente con la aplicación. En el caso de sistemas Unix, el resolver es un conjunto de funciones incluidas en la C library (libc). Especificamente, este tipo de resolver no realiza ninguna forma de caching y se lo suele llamar Stub/Dumb Resolver. El encargado del caching, en tal caso, es el Servidor Local. Existen otras implementaciones que tienen un resolver activo, Smart Resolver, funcionando en cada equipo como si fuese un Servidor Local, que permiten realizar caching u ofrecer funcionalidades extras.

9. ¿Cómo se resuelve un nombre?

    1. Cuando una aplicación requiere un servicio del sistema de DNS, por ejemplo resolver un nombre a su correspondiente dirección IP, invocará la función ofrecida por el resolver. Suponiendo que éste es un Stub Resolver, sólo buscará en su configuración la lista de servidores de nombres locales.
    2. Se envía la consulta al primer servidor de nombres locales. El Servidor Local será el responsable de responderle de forma afirmativa con una o más direcciones IP, o de forma negativa indicando que no encontró lo consultado.
    3. Si el primer servidor no responde(no está activo), el resolver podrá tratar de resolver la consulta utilizando el siguiente de los servidores locales configurados.
    4. Los servidores locales podrán responder utilizando su cache o saliendo a buscar la consulta hacia los ROOT Name Servers. Existe la posibilidad que los servidores locales no hablen, al menos no de forma directa, con los ROOT Name Servers y lo hagan sólo a través de un Forwarder Name Server. También, es posible que el servidor local sea un Servidor Autoritativo y reciba una consulta de un nombre sobre el cual él tiene autoridad. En este caso, responde desde su base de datos de nombres indicando que es una Respuesta Autoritativa, caso contrario, puede responder tomando los datos de la cache, indicando que es una Respuesta NO Autoritativa.
    5. El resolver delega, por completo, la responsabilidad en el Servidor Local y éste se debe encargar de resolver la consulta. *Esto es lo que se llama una **Consulta Recursiva***. Sólo los servidores locales deberı́an admitir consultas recursivas desde los equipos de su misma red. Los ROOT Name Servers no deberı́an admitir prácticamente consultas recursivas.
    6. El Servidor Local, una vez que tiene la consulta y se ha fijado que no es por un nombre local ni está en su caché, deberá intentar resolverla externamente. Podrá intentar resolverla de forma recursiva, preguntando a otro servidor de nombres y delegando la resolución en éste. *Como, en general, las consultas Recursiva están sólo habilitadas de forma local, deberá resolverla con una **Consulta Iterativa** encargándose el mismo*. La consulta iterativa es algo así como "No conozco ese nombre pero preguntá a este servidor".   
    7. Comenzará preguntando, de forma iterativa,a los ROOT Name Servers. Estos no responderán con la resolución del nombre, sino que se fijarán en la consulta, comenzando del último label del nombre(el de más arriba en la jerarquı́a), cuáles son los servidores encargados de este dominio y responderán con una lista de los mismos. Es posible que tengan conocimiento de más labels, lo que permitirá enviar una respuesta más cercana y acortar los saltos de la búsqueda.
    8. Luego, el Servidor Local, a partir de la lista de servidores de nombres para el primer eslabón de la consulta, preguntará al primero de estos, nuevamente, por el nombre completo. Si este servidor es No autoritativo, como sucedı́a con los ROOT Name Servers, para el sub-dominio indicado responderá con otra lista de servidores que tienen delegado el sub-dominio. De esta forma, irá bajando en la jerarquı́a hasta llegar a un Servidor Autoritativo para el sub-dominio consultado.
    9. Cuando la consulta llegue a un Servidor Autoritativo, éste resolverá el nombre de la consulta a la correspondiente dirección IP y se la entregará al Servidor Local.
    10. El Servidor Local, una vez con la consulta resuelta, la guardará en la caché y responderá al Resolver.
    11. Las sucesivas consultas, por el mismo nombre, se podrán resolver directamente desde la caché hasta que venza el tiempo de vida de la entrada en la caché. Si se vence este tiempo, se elimina la entrada de la cache y el proceso se deberá ejecutar nuevamente.

10. Estructura de los Mensajes de DNS

El mensaje de DNS tiene un **encabezado fijo** y un **cuerpo variable**.

* Identificador: valor aleatorio generado por el cliente y copiado por el servidor en la respuesta. Oscila entre 0 y 64K-1. Usado por el cliente para asociar las consultas con las respuestas. Además, el cliente pude usar diferentes números de ports UDP para agregar entropı́a a las consultas. También se lo conoce como Transaction ID.
* Flags: se codifican varias indicaciones. Indican si:
  - Es una consulta o una respuesta(QR).
  - Es autoritativa o no(AA).
  - La respuesta esta truncada o no(TC). Este flag no entra en un mensaje UDP, deberá usarse TCP.
  - Es recursiva o no(RD) habilitada por el cliente.
  - Es recursiva o no (RA) habilitada por servidor.
  - Código de operación.
  - Es estándar una notificación.
  - Un update.
  - Otras cosas locas.
* Contadores varios: de cantidad de consultas y respuestas, sean autoritativas o no, que lleva el mensaje.
* Cuerpo: respuestas y/o consultas más datos adicionales. Dentro de las preguntas y respuestas se pueden trabajar con diferentes tipos de información.

11. Servicios y Registros de DNS

Un servidor de DNS almacena la información con la que trabaja en una base de datos local. En la mayorı́a de los casos no es una base de datos relacional, aunque podrı́a usarse. La DB es una estructura propia del sistema que se genera en memoria una vez que arranca el servicio y se configura desde los archivos que residen en el sistema de archivos local. Dentro de la base de datos, la información se organiza en registros llamados *Resource Record*(RR). Cada uno de estos registros puede guardar diferente tipo de información. Ejemplos de estos tipos se describen a continuación.
* **Registros A**(Address): son registros que mapean de un nombre de dominio a una dirección IP. Son los más comunes. Pueden existir varios registros A con el mismo nombre, por ejemplo, para realizar balance de carga de un servidor muy accedido. Para aprovechar esto, el servidor de DNS deberı́a responder con una lista de direcciones IP, siempre alternando el resultado con algún criterio, por ejemplo de forma circular. Cuando el mapeo de nombre se realiza a una dirección IPv6 entonces es un **registro AAAA**. Ejemplos: 172.20.1.100 es un
* **Registros PTR**(Pointer): son registros que mapean direcciones IP a nombres de dominio. Son el inverso de los registros A, por esto, se los suele llama reversos. Trabajan en el dominio especial in-addr.arpa. Los registros (PTR) deben estar en un sub-árbol(dominio) separado que, como se mencionó más arriba, se llama in-addr.arpa. Esto se debe a que la búsqueda se realiza usando la dirección IP y no el nombre. Aunque, la información existe en los registros directos A, no se puede generar un mecanismo de búsqueda organizado, ya que dada una dirección IP no hay forma de saber en qué zona se encuentra. Para este propósito, está el sub-árbol in-addr.arpa que organiza las direcciones por octeto de las direcciones IP, generando un árbol a modo de ı́ndice de búsqueda. Como una medida de seguridad, las consultas de reversos o registros PTR suelen ser realizadas por los servidores al recibir conexiones TCP. El servidor intentará resolver la dirección IP, desde donde recibe la conexión, para comprobar que es una conexión válida, no está spoofeada. Existen servidores que con solo comprobar la existencia del registro PTR les alcanza para considerar que no hay spoofing. En otros casos más estrictos, los servidores, además, exigen que el valor de este registro concuerde con el registro (A). Si esto no sucede, podrı́an rechazar la conexión.
* **Registros CNAME**(Canonical Name): son registros que mapean de un nombre de dominio a otros nombres. Se los conoce como aliases, debido a que dado un nombre indican el nombre original. Esta funcionalidad podrı́a, también, resolverse con varios registros A. El nombre, al que apunta, deberı́a ser el nombre original, conocido como canónico.
* **Registros HINFO**(Hardware Info): son registros que mapean de un nombre de dominio al hardware y sistema operativo que un equipo posee. No son utilizados habitualmente por cuestiones de seguridad y ahorro de memoria. El formato que lleva el registro debe respetarse, son dos valores: primero un string para el hardware y luego otro para el sistema operativo. Los strings para los valores son arbitrarios.
* **Registros TXT**(Textual): son registros que mapean de un nombre de dominio a información extra asociada con el equipo que tiene dicho nombre, por ejemplo pueden indicar finalidad, usuarios, etc. No son utilizados habitualmente. Se los puede ver en uso asociando una clave pública, utilizando por ejemplo IPSec con un esquema de Opportunistic Encryption.
* **Registros MX**(Mail Exchanger): son registros que indican, para un nombre de dominio, cuáles son los servidores de mail SMTP encargados de recibir los mensajes para ese dominio. De esta forma, no es necesario especificar el servidor completo de mail donde se encuentra la casilla destino, alcanza con indicar, solamente, el dominio. El servidor de mail SMTP que envı́a el mensaje deberá consultar, vı́a el servicio de DNS, cuáles son los servidores SMTP receptores para el dominio dado. Se puede detallar una lista de servidores y asignarles prioridades. Los valores más bajos son las prioridades más altas. Ası́, al momento de hacerse el envı́o del mensaje, si el servidor primario no está activo se podrı́a recurrir a otro de menor prioridad para enviar el e-mail. Con la asignación de prioridades con igual valor se podrı́a lograr un balance de carga entre los distintos servidores SMTP.
* **Registros NS**(Name Server): los registros NS indican los servidores de nombre autoritativos para una zona o sub-dominio. A partir de esto, se puede lograr una delegación de sub-dominios. A diferencia que los registros MX, estos no llevan asociado una prioridad, todos los servidores tienen la misma precedencia. Para lograr un mejor balance, al ir respondiendo se deberı́a ir rotando el orden con el que se entregan los servidores autoritativos para una zona. Al tener varios servidores para un mismo dominio no es necesario configurar a todos con los mismos datos. El software de DNS permite asignar roles de Servidor Primario y Servidor(es) Secundario(s). De esta forma, sólo se requiere configurar el primario y luego el secundario obtendrá una copia de la base de datos del servidor maestro/primario. Es importante que los servidores estén actualizados, por eso debe existir algún mecanismo para mantenerlos sincronizados. El Servidor Primario deberı́a avisar a todos los Servidores Secundarios cuando se realiza un cambio, ası́ estos re-copian la base de datos de nombres desde el servidor maestro. La comunicación entre servidores se realiza vı́a el mismo protocolo de DNS, con la diferencia que se hace sobre TCP en lugar de UDP, esto se debe a que, generalmente, los datos transmitidos ocupan más de 512 bytes(máximo para DNS sobre UDP). Esta operación se llama Transferencia de Zona o, en inglés, Zone Transfer. Se recomienda sobre una configuración de un servidor de DNS, en el cual se delegan las zonas, y las direcciones IP de los servidores delegados están en la zona delegada, agregar para cada registro NS un registro A, indicando la dirección IP del servidor delegado. Esto se utiliza para agilizar las búsquedas y ahorrar una doble consulta. Estas entradas A se las conoce como GLUE RECORDS, ya que "pegan" un nombre de un servidor de nombres con su correspondiente dirección IP.
* **Registros SOA**(Start Of Authority): los registros SOA se crean por cada zona o sub-zona que brinda el servicio de DNS. En este registro se especifican los parámetros globales para todos los registros del dominio o zona. Sólo se admite un registro SOA por zona. Los parámetros que comprende son los siguientes.
  - Nombre del servidor: nombre del servidor de nombres. En general, se llaman ns.... E-mail del administrador: dirección de e-mail del administrador, reemplazando el sı́mbolo arroba “@” por un punto “.”.
  - Número de Serie: número de serie de la DB. Se debe actualizar cada vez que se hace alguna modificación al dominio. Se sugiere un formado YYYYMMDDSS. Tamaño de 32 bits.
  - Refresh Time: indica cada cuánto tiempo los servidores secundarios deben refrescar desde el maestro/primario. Tamaño de 32 bits. Según estándares, se recomienda entre 1200 a 43200 segundos.
  - Retry Time: el tiempo que debe esperar un servidor secundario en intentar contactar nuevamente al primario, ante fallos de conexión, cuando necesita hacer un refresh. Tamaño de 32 bits. Según estándares, se recomienda entre 180 a 900 segundos.
  - Expiry Time: el tiempo en que deja de ser autoritativa una zona. Luego de este tiempo, el servidor secundario debe chequear el Serial de la SOA del maestro y, si cambió, realizar una Transferencia de Zona: AFXR(*Asynchronous Full Transfer Zone*)/IXFR(*Incremental Zone Transfer*). Tamaño de 32 bits. Según estándares, se recomienda entre 1209600 a 2419200 segundos.
  - TTL(*time-to-live*): en un principio se utilizaba como el Tiempo de Vida de un registro en una caché. Ahora se utiliza como el TTL de Cacheo Negativo: si se pregunta por un valor y el servidor autoritativo respondió que no lo tiene, no se volverá a preguntar por el tiempo de este valor. Tamaño de 32 bits. El TTL se puede indicar para cada uno de los RRs o definir uno global, depende de la implementación. Este valor no es parte del SOA. En el caso de BIND 9, se define con la macro $TTL. El TTL se aplica de forma global, pero se puede re-escribir para registros en particular. Por ejemplo, si no se desea que se haga caching por mucho tiempo, se puede poner un tiempo de expiración de segundos.

12. Otras características de DNS: *Dynamic DNS* y *Split DNS*

* **Dynamic DNS**(DDNS): es decir, la actualización de los DNS de forma dinámica. En la actualidad, existen varios servicios de DDNS(e.g. www.dyndns.org) que permiten utilizar una conexión SOHO(Small Office - Home Office) con dirección IP pública, pero dinámica, rotada por el ISP(e.g. ADSL, Cable-Modém). Esto es posible gracias a la capacidad de actualización dinámica de un servidor de DNS.
* **Split DNS**: un Split o Stealth DNS es un servicio que tiene diferentes “personalidades”(responde con diferente información) de acuerdo al cliente que lo consulta o servidor que lo utiliza. Con el servicio de BIND utilizado en estos ejemplos se puede implementar a través de *views*. Este facilidad está sólo disponiblea partir del BIND 9.X. Un ejemplo podría ser cuando a los sistemas de una red local se les responde con una información y, a los demás, con otra. Esto puede ser útil si se tiene una intranet con servidores que pueden ser de acceso público(mediante NAT, por ejemplo) y, también, de forma local desde la red privada. Es importante notar que, para evitar configuraciones erroneas todas las zonas deben estar definidas en todas las *views*. En las versiones nuevas de BIND este chequeo se hace al arrancar y si no esta de forma correcta no funciona el servicio.
* **Delegación de Reverso con CIDR**(*Classless Inter-Domain Routing*): el dominio de los reversos in-addr.arpa fue pensado de forma classful. Hoy en dı́a, el direccionamiento classful ha sido reemplazado por el CIDR, convirtiéndolo en classless. Para poder delegar un sub-dominio de una subred en el dominio de los reversos, lo que se utiliza es un registro CNAME para poder subdelegar una parte de la subred.
